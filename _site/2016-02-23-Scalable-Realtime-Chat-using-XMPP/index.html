<h2 id="problem--">Problem -</h2>

<p>I got a chance to work on multiple asych real time applications on the web early in my career. Being part of an e-learning product cloud demanded us to build high scale real time chat use cases for collaborative learning experience. These applications were running on desktop browsers, mobile/tablet browsers and on android/iOS native apps.</p>

<div style="text-align: center">
<figure class="full">
	<img src="/images/chat.jpg" width="600px" alt="" />
</figure>
</div>

<p>To deliver a simple chat is easy but when you try doing it at scale and evolve its architecture to make it reliable taught me many interesting learnings. Some of the challenges include -</p>

<ul>
  <li>Roster management to show who of my contacts are online.</li>
  <li>Deliver real time chat messages , including media content.</li>
  <li>Maintain high concurrency for all operations.</li>
  <li>Chat history management.</li>
  <li>Notifications.</li>
  <li>Handling chat events across multiple tabs/browsers and devices. Synchronize them.</li>
  <li>Blocking calls from other contacts if userâ€™s call is active.</li>
  <li>Handle hardware usage diligently call has ended.</li>
  <li>Group chats and group calls</li>
  <li>Cost effective design</li>
</ul>

<h2 id="solution--">Solution -</h2>

<div style="text-align: center"><iframe src="//www.slideshare.net/slideshow/embed_code/key/fYvQrGAiRvuXz8" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen=""> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/udayslideshare/scalable-real-time-chat-text-audio-video-implemented-using-xmpp" title="Scalable Real Time Chat (Text, Audio, Video) - Implemented using XMPP" target="_blank">Scalable Real Time Chat (Text, Audio, Video) - Implemented using XMPP</a> </strong> from <strong><a href="https://www.slideshare.net/udayslideshare" target="_blank">Udaya Kiran</a></strong> </div></div>

<h2 id="results">Results</h2>

<p>We could achive 800k connects per server on Ejabberd with 8 GB primary memory. Successfully Scaled up entire chat system to meet low latency text, audio and video chat needs.</p>

<h2 id="references">References</h2>

<ul>
  <li>XMPP and WebSocket - http://stackoverflow.com/a/26560860, https://blog.andyet.com/2014/10/30/websocket/</li>
  <li>XMPP over Socket.io - http://stackoverflow.com/a/33868081</li>
  <li>Jingle - http://xmpp.org/extensions/xep-0166.pdf</li>
  <li>XMPP fundamental stanza examples - <a href="http://xmpp.org/rfcs/rfc3921.html">http://xmpp.org/rfcs/rfc3921.html#stanzas-presence-children-show</a></li>
  <li>BOSH vs WebSockets - http://stackoverflow.com/a/6442488</li>
  <li>XMPP and WebRTC - https://xmpp.org/uses/webrtc.html</li>
  <li>Lua vs Erlang - http://vschart.com/compare/lua/vs/erlang-programming-language</li>
</ul>

